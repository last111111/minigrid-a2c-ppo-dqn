# é¡¹ç›®å®‰è£…å’Œä½¿ç”¨å®Œæ•´è¯´æ˜

## ğŸ“¦ ä¸€ã€å®‰è£…æ­¥éª¤

### âœ… æ¨èæ–¹å¼ï¼šä½¿ç”¨è‡ªåŠ¨å®‰è£…è„šæœ¬

**Windows ç”¨æˆ·ï¼š**
1. æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼ˆWin+R â†’ è¾“å…¥ `cmd` â†’ å›è½¦ï¼‰
2. åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•ï¼š
   ```cmd
   cd C:\Users\17140\Desktop\minigrid-a2c-ppo-dqn
   ```
3. è¿è¡Œå®‰è£…è„šæœ¬ï¼š
   ```cmd
   install_dependencies.bat
   ```

**Linux/Mac ç”¨æˆ·ï¼š**
```bash
cd /path/to/minigrid-a2c-ppo-dqn
chmod +x install_dependencies.sh
./install_dependencies.sh
```

---

### ğŸ”§ æ‰‹åŠ¨å®‰è£…ï¼ˆå¦‚æœè‡ªåŠ¨è„šæœ¬å¤±è´¥ï¼‰

æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. å®‰è£… PyTorchï¼ˆå¸¦ CUDA 11.3ï¼‰
python -m pip install torch==1.12.1+cu113 torchvision==0.13.1+cu113 torchaudio==0.12.1 --extra-index-url https://download.pytorch.org/whl/cu113

# 2. å®‰è£…é¡¹ç›®ä¾èµ–
python -m pip install -r requirements.txt

# 3. å®‰è£… minigrid
cd minigrid
python -m pip install -e .
cd ..

# 4. å®‰è£… torch-ac
cd torch-ac
python -m pip install -e .
cd ..
```

---

## âœ”ï¸ äºŒã€éªŒè¯å®‰è£…

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç¡®è®¤å®‰è£…æˆåŠŸï¼š

```bash
python -c "import torch; print('PyTorch:', torch.__version__); print('CUDA:', torch.cuda.is_available())"
python -c "import gym_minigrid; print('MiniGrid: OK')"
python -c "import torch_ac; print('torch-ac: OK')"
python -c "import matplotlib; print('matplotlib: OK')"
```

**é¢„æœŸè¾“å‡ºï¼š**
```
PyTorch: 1.12.1+cu113
CUDA: True
MiniGrid: OK
torch-ac: OK
matplotlib: OK
```

---

## ğŸ§ª ä¸‰ã€å¿«é€Ÿæµ‹è¯•

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯æ‰€æœ‰åŠŸèƒ½ï¼ˆåŒ…æ‹¬æ–°å¢çš„æˆåŠŸç‡è¿½è¸ªï¼‰ï¼š

```bash
python quick_test_success_rate.py
```

æµ‹è¯•å°†ï¼š
- âœ… è®­ç»ƒä¸€ä¸ªç®€å•çš„ PPO æ™ºèƒ½ä½“ï¼ˆ200 episodesï¼Œçº¦ 2-3 åˆ†é’Ÿï¼‰
- âœ… æ˜¾ç¤ºå®æ—¶æˆåŠŸç‡ï¼ˆSR100 å’Œ SRbï¼‰
- âœ… è‡ªåŠ¨ç”ŸæˆæˆåŠŸç‡å˜åŒ–å›¾
- âœ… éªŒè¯æ‰€æœ‰è¾“å‡ºæ–‡ä»¶

---

## ğŸš€ å››ã€å¼€å§‹è®­ç»ƒ

### åŸºç¡€è®­ç»ƒå‘½ä»¤

```bash
python scripts/train.py \
    --algo ppo \
    --env MiniGrid-FourRooms-v0 \
    --episodes 1000 \
    --procs 16 \
    --save-interval 10
```

### è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ–°åŠŸèƒ½

è®­ç»ƒæ—¥å¿—ç°åœ¨ä¼šæ˜¾ç¤ºï¼š

```
U 50 | E 800 | F 102400 | FPS 1234 | D 83 | rR:Î¼ÏƒmM 0.65 0.12 0.10 0.85 | F:Î¼ÏƒmM 45.2 12.3 15 89 | H 1.234 | V 0.456 | pL 0.023 | vL 0.015 | âˆ‡ 0.234 | SR100 85.0% | SRb 87.5%
                                                                                                                                                                            â†‘           â†‘
                                                                                                                            æœ€è¿‘100æ¬¡æˆåŠŸç‡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                                                                                                                            å½“å‰æ‰¹æ¬¡æˆåŠŸç‡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®­ç»ƒç»“æŸå

è‡ªåŠ¨ç”Ÿæˆï¼š
1. **æˆåŠŸç‡å›¾è¡¨**: `storage/{æ¨¡å‹å}/success_rate_plot.png`
2. **è®­ç»ƒæ—¥å¿—**: `storage/{æ¨¡å‹å}/log.txt`
3. **CSV æ•°æ®**: `storage/{æ¨¡å‹å}/log.csv`ï¼ˆåŒ…å« success_rate_100 åˆ—ï¼‰
4. **ç»Ÿè®¡æ‘˜è¦**: æ‰“å°åˆ°æ§åˆ¶å°

```
============================================================
SUCCESS RATE SUMMARY
============================================================
Total Episodes: 1600
Overall Success Rate: 78.44%
Final 100 Episodes Success Rate: 92.00%
Success rate plot saved to: storage/.../success_rate_plot.png
============================================================
```

---

## ğŸ“š äº”ã€å¸¸ç”¨å‘½ä»¤

### 1. PPO è®­ç»ƒï¼ˆé»˜è®¤å‚æ•°ï¼‰
```bash
python scripts/train.py --algo ppo --env MiniGrid-FourRooms-v0 --episodes 1000
```

### 2. A2C è®­ç»ƒ
```bash
python scripts/train.py --algo a2c --env MiniGrid-FourRooms-v0 --episodes 1000 --procs 16
```

### 3. è°ƒæ•´è¶…å‚æ•°
```bash
python scripts/train.py \
    --algo ppo \
    --env MiniGrid-FourRooms-v0 \
    --episodes 2000 \
    --procs 16 \
    --lr 0.001 \
    --entropy-coef 0.01 \
    --epochs 4 \
    --batch-size 256
```

### 4. è¯„ä¼°è®­ç»ƒå¥½çš„æ¨¡å‹
```bash
python scripts/evaluate.py --env MiniGrid-FourRooms-v0 --model {æ¨¡å‹åç§°}
```

### 5. å¯è§†åŒ–æ™ºèƒ½ä½“è¡Œä¸º
```bash
python scripts/visualize.py --env MiniGrid-FourRooms-v0 --model {æ¨¡å‹åç§°}
```

---

## ğŸ“Š å…­ã€æŸ¥çœ‹è®­ç»ƒç»“æœ

### å®æ—¶ç›‘æ§ï¼ˆTensorBoardï¼‰
```bash
tensorboard --logdir storage/{æ¨¡å‹åç§°}
```
ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€ http://localhost:6006

### æŸ¥çœ‹æˆåŠŸç‡å›¾è¡¨
```bash
# Windows
start storage/{æ¨¡å‹åç§°}/success_rate_plot.png

# Linux
xdg-open storage/{æ¨¡å‹åç§°}/success_rate_plot.png

# Mac
open storage/{æ¨¡å‹åç§°}/success_rate_plot.png
```

### åˆ†æ CSV æ•°æ®
```python
import pandas as pd
import matplotlib.pyplot as plt

# è¯»å–è®­ç»ƒæ—¥å¿—
df = pd.read_csv('storage/{æ¨¡å‹åç§°}/log.csv')

# ç»˜åˆ¶æˆåŠŸç‡å˜åŒ–
plt.figure(figsize=(10, 5))
plt.plot(df['episodes'], df['success_rate_100'], label='SR100')
plt.xlabel('Episodes')
plt.ylabel('Success Rate')
plt.legend()
plt.grid(True)
plt.savefig('custom_plot.png')
plt.show()
```

---

## ğŸ” ä¸ƒã€å¯ç”¨çš„ç¯å¢ƒ

é¡¹ç›®æ”¯æŒå¤šç§ MiniGrid ç¯å¢ƒï¼š

| ç¯å¢ƒåç§° | éš¾åº¦ | è¯´æ˜ |
|---------|------|------|
| `MiniGrid-Empty-5x5-v0` | â­ ç®€å• | ç©ºæˆ¿é—´ï¼Œç›´æ¥åˆ°è¾¾ç›®æ ‡ |
| `MiniGrid-Empty-8x8-v0` | â­ ç®€å• | æ›´å¤§çš„ç©ºæˆ¿é—´ |
| `MiniGrid-FourRooms-v0` | â­â­ ä¸­ç­‰ | å››ä¸ªæˆ¿é—´ï¼Œéœ€è¦æ‰¾é—¨é€šè¿‡ |
| `MiniGrid-DoorKey-5x5-v0` | â­â­â­ å›°éš¾ | éœ€è¦æ‹¿é’¥åŒ™å¼€é—¨ |
| `MiniGrid-DoorKey-6x6-v0` | â­â­â­ å›°éš¾ | æ›´å¤§çš„é’¥åŒ™å¼€é—¨ä»»åŠ¡ |
| `MiniGrid-MultiRoom-N2-S4-v0` | â­â­â­ å›°éš¾ | å¤šæˆ¿é—´å¯¼èˆª |

**è‡ªå®šä¹‰ç¯å¢ƒ**ï¼ˆåœ¨ `minigrid/gym_minigrid/envs/custom.py` ä¸­ï¼‰ï¼š
- `MiniGrid-FourDoor-v0`
- `MiniGrid-10FourDoor-v0`
- `MiniGrid-Maze-v0`

---

## ğŸ¯ å…«ã€è¶…å‚æ•°è¯´æ˜

### PPO å…³é”®å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ | è°ƒä¼˜å»ºè®® |
|------|--------|------|----------|
| `--lr` | 0.001 | å­¦ä¹ ç‡ | ç¯å¢ƒç®€å•ç”¨ 0.001ï¼Œå›°éš¾ç”¨ 0.0003 |
| `--epochs` | 4 | æ¯æ‰¹æ•°æ®è®­ç»ƒè½®æ•° | 3-10ï¼Œè¶Šå¤§æ•°æ®åˆ©ç”¨ç‡è¶Šé«˜ |
| `--batch-size` | 256 | Mini-batch å¤§å° | 64-512ï¼Œå–å†³äº GPU å†…å­˜ |
| `--entropy-coef` | 0.01 | ç†µç³»æ•°ï¼ˆæ¢ç´¢ï¼‰ | æ¢ç´¢ä¸è¶³æ—¶æé«˜åˆ° 0.02 |
| `--clip-eps` | 0.2 | PPO è£å‰ªèŒƒå›´ | 0.1-0.3 |
| `--frames-per-proc` | 128 | æ¯è¿›ç¨‹é‡‡æ ·å¸§æ•° | å½±å“æ›´æ–°é¢‘ç‡ |
| `--procs` | 16 | å¹¶è¡Œç¯å¢ƒæ•° | è¶Šå¤šè¶Šå¿«ï¼Œä½†åƒå†…å­˜ |

### A2C å…³é”®å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `--lr` | 0.001 | å­¦ä¹ ç‡ |
| `--frames-per-proc` | 5 | æ¯è¿›ç¨‹é‡‡æ ·å¸§æ•°ï¼ˆæ¯” PPO å°‘ï¼‰ |
| `--procs` | 16 | å¹¶è¡Œç¯å¢ƒæ•° |

---

## ğŸ“– ä¹ã€æ–‡æ¡£ç´¢å¼•

é¡¹ç›®åŒ…å«ä»¥ä¸‹æ–‡æ¡£ï¼š

1. **INSTALLATION_GUIDE.md** - å®Œæ•´å®‰è£…æŒ‡å—
2. **SUCCESS_RATE_TRACKING.md** - æˆåŠŸç‡è¿½è¸ªåŠŸèƒ½è¯¦è§£
3. **README.md** - é¡¹ç›®æ¦‚è¿°
4. **INSTALL_INSTRUCTIONS.txt** - ç®€æ˜å®‰è£…è¯´æ˜

---

## âš ï¸ åã€å¸¸è§é—®é¢˜

### Q1: CUDA ä¸å¯ç”¨
**A**: æ£€æŸ¥ï¼š
1. NVIDIA é©±åŠ¨å·²å®‰è£…
2. CUDA 11.3 å·²å®‰è£…
3. PyTorch ç‰ˆæœ¬æ­£ç¡®ï¼ˆåŒ…å« `+cu113`ï¼‰

å¦‚æœæ²¡æœ‰ GPUï¼Œç”¨ CPU ç‰ˆæœ¬ï¼š
```bash
pip install torch==1.12.1 torchvision==0.13.1 torchaudio==0.12.1
```

### Q2: è®­ç»ƒå¾ˆæ…¢
**A**:
- å‡å°‘ `--procs`ï¼ˆå¹¶è¡Œç¯å¢ƒæ•°ï¼‰
- ä½¿ç”¨æ›´ç®€å•çš„ç¯å¢ƒæµ‹è¯•
- ç¡®è®¤ GPU è¢«æ­£ç¡®ä½¿ç”¨ï¼ˆ`torch.cuda.is_available()` è¿”å› Trueï¼‰

### Q3: æˆåŠŸç‡å§‹ç»ˆä¸º 0%
**A**:
- ç¯å¢ƒå¯èƒ½å¤ªéš¾ï¼Œå°è¯•æ›´ç®€å•çš„ç¯å¢ƒï¼ˆå¦‚ Empty-5x5ï¼‰
- å¢åŠ è®­ç»ƒ episodes
- è°ƒé«˜ `--entropy-coef` å¢åŠ æ¢ç´¢
- é™ä½å­¦ä¹ ç‡ `--lr`

### Q4: æ²¡æœ‰ç”ŸæˆæˆåŠŸç‡å›¾è¡¨
**A**:
- ç¡®è®¤è®­ç»ƒè‡ªç„¶ç»“æŸï¼ˆä¸æ˜¯ Ctrl+C ä¸­æ–­ï¼‰
- æ£€æŸ¥ matplotlib æ˜¯å¦å®‰è£…ï¼š`pip install matplotlib`
- æŸ¥çœ‹è®­ç»ƒæ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

### Q5: å†…å­˜ä¸è¶³
**A**:
- å‡å°‘ `--procs`ï¼ˆå¹¶è¡Œç¯å¢ƒæ•°ï¼‰
- å‡å°‘ `--batch-size`
- å‡å°‘ `--frames-per-proc`

---

## ğŸ“ åä¸€ã€è®­ç»ƒå»ºè®®

### æ–°æ‰‹å»ºè®®æµç¨‹

1. **å…ˆæµ‹è¯•ç®€å•ç¯å¢ƒ**ï¼š
   ```bash
   python scripts/train.py --algo ppo --env MiniGrid-Empty-5x5-v0 --episodes 200
   ```

2. **éªŒè¯åŠŸèƒ½æ­£å¸¸**ï¼š
   - æŸ¥çœ‹è®­ç»ƒæ—¥å¿—ä¸­çš„ SR100
   - æ£€æŸ¥ success_rate_plot.png æ˜¯å¦ç”Ÿæˆ

3. **å°è¯•ä¸­ç­‰éš¾åº¦**ï¼š
   ```bash
   python scripts/train.py --algo ppo --env MiniGrid-FourRooms-v0 --episodes 1000
   ```

4. **è°ƒä¼˜è¶…å‚æ•°**ï¼š
   - æ ¹æ®æˆåŠŸç‡æ›²çº¿è°ƒæ•´å­¦ä¹ ç‡å’Œæ¢ç´¢å‚æ•°

5. **æŒ‘æˆ˜å›°éš¾ç¯å¢ƒ**ï¼š
   ```bash
   python scripts/train.py --algo ppo --env MiniGrid-DoorKey-6x6-v0 --episodes 2000
   ```

### å®éªŒå¯¹æ¯”å»ºè®®

å¯¹æ¯”ä¸åŒç®—æ³•ï¼š
```bash
# PPO
python scripts/train.py --algo ppo --env MiniGrid-FourRooms-v0 --model ppo_test --episodes 1000

# A2C
python scripts/train.py --algo a2c --env MiniGrid-FourRooms-v0 --model a2c_test --episodes 1000

# å¯¹æ¯”æˆåŠŸç‡å›¾è¡¨
# æŸ¥çœ‹ storage/ppo_test/success_rate_plot.png
# æŸ¥çœ‹ storage/a2c_test/success_rate_plot.png
```

---

## ğŸ“ åäºŒã€è·å–å¸®åŠ©

å¦‚æœ‰é—®é¢˜ï¼š
1. æŸ¥çœ‹ç›¸å…³æ–‡æ¡£ï¼ˆè§ç¬¬ä¹èŠ‚ï¼‰
2. æ£€æŸ¥è®­ç»ƒæ—¥å¿— `storage/{æ¨¡å‹å}/log.txt`
3. æŸ¥çœ‹é¡¹ç›® issues
4. å‚è€ƒ MiniGrid å®˜æ–¹æ–‡æ¡£ï¼šhttps://github.com/Farama-Foundation/Minigrid

---

ç¥æ‚¨è®­ç»ƒé¡ºåˆ©ï¼ğŸ‰
